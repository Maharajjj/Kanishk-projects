# Kanishk-projects FOR WINDOWS
Projects I have done and working on

Introduction

In the wake of cyber incidents such as ransomware attacks or phishing emails, the role of email forensics becomes pivotal in unraveling the intricate web of digital footprints left behind. This project ventures into the domain of email forensics, a potent investigative approach used post-cyber incidents to dissect, analyze, and draw insights from email communications.

Email forensics is a cornerstone in the aftermath of cyber assaults, particularly in situations involving ransomware attacks and phishing emails. It serves as a critical investigative tool, delving into the concealed layers of email interactions, identifying malicious intent, and gathering crucial evidence to trace the origins of these attacks.

Key Objectives:

Analyzing Post-Incident Emails: Understanding the anatomy of email structures and analyzing content following a cybersecurity breach.
Forensic Methodologies: Exploring the methodologies and tools used in deciphering emails to trace potential threats.
Identifying Malicious Signatures: Unveiling digital artifacts and signatures to identify and decipher malicious activities in emails.
Legal and Security Implications: Understanding the legal and security implications of the discovered evidence in post-incident investigations.

Significance:

Email forensics is an instrumental approach used to conduct post-incident investigations, especially after ransomware or phishing email attacks. This project aims to illustrate the critical role of email forensics in untangling the complexities of post-cyber incident scenarios. By offering an in-depth exploration of email forensics methodologies, it provides insights into the investigative techniques essential for uncovering the origins and impact of cyber threats hidden within electronic communications.

This project acts as a guide to understanding the methodologies and tools employed in email forensics, crucial in the aftermath of cyber incidents, thereby shedding light on post-attack investigations and strategies to fortify cybersecurity measures.















1.1.	Problem Definition

In today's digital landscape, cyber threats like ransomware attacks and phishing emails have become increasingly prevalent, posing significant risks to individuals and organizations. Email serves as a primary gateway for cybercriminals to deploy attacks, making post-incident investigation critical to understanding and mitigating these threats.

Problem Statement:

The problem lies in comprehensively investigating and analyzing emails post-cybersecurity incidents, particularly following ransomware attacks or phishing emails, to uncover the origins, methods, and impact of these threats. The goal is to develop a robust email forensics approach capable of unraveling the intricacies of email communications for digital incident response and cybersecurity measures.

Challenges and Objectives:

Data Complexity: Emails contain multifaceted and often obfuscated content, necessitating advanced tools and methodologies to sift through vast amounts of data.

Malicious Patterns Identification: Identifying and isolating malicious patterns, attachments, or embedded links in emails to trace back the source and intent of the cyber incident.

Legal and Ethical Implications: Addressing legal and ethical considerations in extracting and interpreting evidence obtained from email forensics.

Security Recommendations: Generating actionable insights from email forensics to recommend robust cybersecurity measures against future threats.

Scope:

This problem statement focuses on post-incident email forensics applied after ransomware attacks or phishing emails. It aims to develop effective methods to investigate, analyze, and interpret email content, attachments, and communication trails to aid in incident response and fortify cybersecurity measures.

Outcomes:

The outcome of this endeavor will be an enriched understanding of email forensics in post-cyber incident scenarios. It will yield methodologies, tools, and insights vital for identifying, investigating, and interpreting the implications of ransomware attacks and phishing emails through the lens of email forensics.








1.2.	Core Components

The core components of an email forensics project post a cybersecurity incident involving ransomware attacks or phishing emails typically involve:

Email Data Acquisition: Collecting, retrieving, and preserving email data from relevant sources. This process may include acquiring data from email servers, cloud accounts, local machine storage, or backups. Different email formats such as .eml, .msg, or .pst might need specialized handling.

Email Content Analysis: Parsing through email content, including the message body, attachments, sender information, recipient details, timestamps, and header details. This step involves examining the content for suspicious elements, potential malware, or phishing indicators.

Digital Evidence Extraction: Extracting digital evidence related to the cyber incident, such as IP addresses, URLs, email addresses, or any malicious artifacts, attachments, or links. Tools and methods for data carving and extraction from email sources are utilized.

Malware and Phishing Identification: Employing anti-malware tools, sandboxing, or threat intelligence to identify and classify malware, potential ransomware, or phishing elements in the email content.

Metadata and Header Examination: Analyzing email headers for signs of spoofing, tampering, or anomalies in routing paths, including the "Received" headers. It helps track the origin, path, and authenticity of the email.

Data Visualization and Reporting: Presenting the findings in a comprehensible and informative manner. This could involve data visualization, timeline analysis, and generating detailed reports with visual aids for conveying the analysis to stakeholders.

Legal and Ethical Considerations: Adhering to legal and ethical guidelines while collecting, handling, and interpreting email data. This involves ensuring privacy, maintaining evidence integrity, and following chain-of-custody protocols.

Recommendations and Remediation: Providing actionable recommendations and steps for enhancing cybersecurity posture, improving email security, and preventing future incidents based on the forensic analysis.

Tool Development and Automation: Creating or utilizing specialized tools and automation to streamline the email forensics process. Automation aids in accelerating the data analysis, evidence extraction, and reporting phases.

Documentation and Collaboration: Thorough documentation of the processes, methods, and findings is crucial for collaboration and future reference by cybersecurity teams, legal entities, and stakeholders.





1.3.	Project Profile

Project Profile: Email Forensics Investigation System
Overview
The Email Forensics Investigation System is a comprehensive tool developed to conduct in-depth analysis of email data following cybersecurity incidents, specifically ransomware attacks or phishing attempts. Leveraging advanced techniques, this system aims to identify, extract, and analyse digital evidence from email sources, unravelling the nature and source of security threats.
Objectives:
•	Forensic Analysis: Perform detailed examination and analysis of email content, including attachments, headers, and message bodies, to uncover evidence of potential malware, phishing, or suspicious activities.
•	Digital Evidence Extraction: Employ specialized methods to extract and interpret digital artifacts such as IP addresses, URLs, email addresses, and other indicators present in email data.
•	Malware and Phishing Identification: Utilize malware analysis and threat intelligence to detect and classify potential ransomware, phishing attacks, or other security threats embedded in emails.
•	Reporting and Recommendations: Generate comprehensive reports with findings, visual representations, and actionable recommendations to assist in incident response and preventive measures.
Core Components:
•	Email Data Acquisition: Collect and preserve email data from various sources including email servers, cloud accounts, and local backups.
•	Email Content Analysis: Scrutinize email content for signs of malicious attachments, spoofing, or phishing elements.
•	Header Examination: Analyse email headers to track the origin and path of the emails, identifying anomalies or signs of tampering.
•	Digital Evidence Extraction: Extract digital artifacts such as IP addresses, URLs, or email addresses from the email content for further investigation.
•	Visualization and Reporting: Present the findings in an informative manner using visual aids and comprehensive reports.
Key Features:
•	Advanced tools for parsing and analyzing email content.
•	Automated extraction of digital evidence.
•	Malware and phishing identification using threat intelligence.
•	Reporting capabilities with visual representation of findings.
Target Audience:
•	Cybersecurity professionals, digital forensic experts, incident response teams.
•	Legal entities, law enforcement, and organizations dealing with cybersecurity incidents.
•	Stakeholders involved in post-attack investigations.
Benefits:
•	Enhances incident response capabilities following email-based cyber threats.
•	Facilitates evidence-based decision-making during security incidents.
•	Enables proactive security improvements and threat prevention.





1.4 Assumptions and Constraints

Assumptions:
1.	Email Authenticity: The system assumes that the provided emails for investigation are authentic and have not been altered or tampered with.
2.	Legal Compliance: The project assumes compliance with legal regulations and standards pertaining to digital forensics investigations.
3.	Integrity of Digital Evidence: It assumes that the evidence extracted from emails maintains its integrity throughout the investigation process.
4.	No Access Limitations: The system operates under the assumption that authorized access to the email sources for investigation is available.
Constraints:
1.	Data Privacy Regulations: The project adheres to data privacy laws and may have constraints in handling sensitive or personally identifiable information.
2.	Resource Limitations: Constraints regarding computational resources, processing power, or storage might affect the volume of data that can be analyzed.
3.	Complex Encryption: The effectiveness of the system might be limited by complex encryption techniques used in emails, potentially hindering the analysis.
4.	Varying Email Providers: The system might face challenges in processing emails from various providers with different data structures or formats.






























Requirement Determination & Analysis
2.1.	Requirement Determination

The technical requirements for the Email Forensics Investigation System encompass the following aspects:
1.	Programming Language and Frameworks:
•	Python: Utilizing Python for its versatility, extensive libraries for email parsing (such as email, extract_msg), data analysis (pandas, numpy), and GUI frameworks (tkinter, PyQt).
•	Shell Scripting: Developing shell scripts for executing batch processing, file operations, and system-level tasks.

2.	Operating Systems:
•	Cross-Platform Compatibility: Ensuring compatibility across major operating systems such as Windows, Linux, and macOS to cater to a diverse user base.
•	Linux Distributions: Compatibility with different distributions of Linux, leveraging its open-source nature and flexibility for forensic purposes.

3.	Email Formats and Protocols:
•	Support for Multiple Email Formats: Capability to handle various email formats, including .eml, .msg, and other standard formats used across different email clients.
•	Email Protocols: Integration with POP3, IMAP, and SMTP protocols to fetch, parse, and analyze emails directly from mail servers.

4.	Data Parsing and Extraction:
•	Parsing Libraries: Usage of Python email parsing libraries (email, extract_msg) for extracting email metadata, body content, and attachments.
•	Regex and Data Analysis: Implementing regular expressions and data analysis libraries to identify and extract specific patterns such as URLs, IP addresses, and email addresses from email content.

5.	Graphical User Interface (GUI):
•	GUI Development: Employing GUI frameworks such as tkinter, PyQt, or wxPython to create a user-friendly interface for users to interact with the system.
•	Styling and Modernization: Enhancing the visual design of the interface to present a professional and user-friendly appearance.

6.	File Handling and Storage:
•	File Management: Managing attachments and extracted data by interacting with the file system, organizing files, and storing outputs in designated folders.
•	Storage Capabilities: Utilizing disk storage and file systems efficiently for storing extracted email data and investigation results






2.2 Targeted Users

The Email Forensics Investigation System targets a diverse range of users including:
•	Cybersecurity Professionals: Forensic analysts and cybersecurity experts involved in examining phishing, ransomware, or cyber threats related to emails.
•	Law Enforcement Agencies: Investigators requiring tools for analyzing email-based evidence during legal proceedings or cybercrime investigations.
•	Forensic Analysts: Professionals dealing with digital evidence examination in private or corporate forensics, looking into the authenticity of emails, and identifying digital footprints.
•	General Users: Individuals needing to investigate, retrieve, or analyze their own email data for suspicious activities.






 



















2.3 Details of Tools and Techniques Used / Implemented

•	Python Programming: Utilizing Python and its libraries such as email, extract_msg, and other analysis tools for email parsing and extraction of attachments, email metadata, and content.
•	Shell Scripting: Employing shell scripts for batch processing, file management, and executing system-level commands.
•	Regular Expressions (Regex): Utilizing regular expressions to identify patterns like URLs, IP addresses, and email addresses within the email content.
•	GUI Frameworks: Using tkinter, PyQt, or similar frameworks to build a user-friendly interface for email data retrieval and analysis.
•	Forensic Techniques: Implementing forensic methodologies to preserve, collect, examine, and present digital evidence contained within email files.




 




















2.4 Advantages and Limitations of the Used Security Tools

Advantages:
•	User-Friendly Interface: The GUI enables ease of use for individuals without extensive technical knowledge.
•	Cross-Platform Compatibility: Works seamlessly on Windows, Linux, and macOS, catering to a broad user base.
•	Email Format Support: Handles various email formats and protocols for broad compatibility.
•	Powerful Parsing Techniques: Utilizes Python libraries and regex to extract relevant data from email files.


Limitations:
•	Limited to Supported Formats: The tool might have constraints when handling non-standard or proprietary email formats.
•	Tool Reliance on Libraries: The behaviour of the tool may be impacted by library updates or compatibility issues.
•	Complex Forensic Analysis: Comprehensive forensic analysis might require additional tools and expertise beyond the scope of this system.





























Project Design

3.1.	Flow chart

 


	



3.2 Dataset details



Data Source:
The data was obtained from various sources, including email backups and repositories, containing emails that are suspected of being involved in cyber-attacks such as social engineering, phishing, and ransomware.

Data Structure:
The dataset comprises email files in .eml and .msg formats, including email attachments and body content. Emails are organized in separate directories based on the attack type (social engineering, phishing, or ransomware).

Identification Keywords for Malicious Emails
Social Engineering:
•	Subject: "Urgent: Action Required"
•	Sender: Unknown domain addresses
•	Phrases: "Suspicious login attempt," "Password reset required"
•	Attachments: Unknown file extensions or executable files
•	Links: URL-shortened links
Phishing:
•	Subject: "Your Account has been Suspended"
•	Sender: Imitated reputable companies (e.g., PayPal, Microsoft, Banks)
•	Content: Requests for personal information or financial details
•	Attachments: Invoices or fake documents (e.g., .docm, .exe)
•	Links: Misleading URL redirects or masked domains
Ransomware:
•	Subject: "Critical Security Alert"
•	Sender: Unknown or impersonating system admin or authority figures
•	Phrases: "Your files are encrypted," "Pay to unlock"
•	Attachments: .zip files, .js files, unknown file extensions
•	Links: Links with no clear source or using URL shorteners
Common Identifiers:
•	Emails marked as "Urgent" or "Confidential"
•	Misspelled company names or domains
•	Generic greetings ("Dear Customer")
•	Attachments with executable or double extensions (e.g., .pdf.exe)
•	Unsolicited emails from unknown sources

These identifiers can help in developing rules for filtering and identifying potentially malicious emails across different attack types. Adjust and enhance these based on specific patterns and characteristics observed in your dataset.








Development

4.1 Script details / Source code


4.1 Script Details / Source Code
The email forensics tool is developed using Python as the primary scripting language and incorporates several libraries for email extraction, analysis, and identification of potentially malicious content within emails.

Main Components:
1.	Script Language: Python 3.0 and above.
2.	Libraries Used:
•	tkinter: For the Graphical User Interface (GUI) creation.
•	subprocess: To execute external commands and batch files.
•	email, extract_msg: For email file processing and extraction of data from .eml and .msg files.
•	re: For regular expressions used in identifying specific patterns within emails.
•	colorama: Used for terminal text colorization and formatting.
•	PIL and ImageTk from Pillow: Employed for loading and displaying images in the GUI.

Script Functions:
1.	Browse Input/Output Folders: Allows the user to select input and output directories.
2.	Batch Script Execution: Executes the primary batch script that processes the emails within the selected directories.


Additional Details:
The graphical user interface (GUI) created using tkinter provides an intuitive and user-friendly means to interact with the script. The backend functionalities, such as email parsing, analysis, and identification, are performed through a series of defined functions within the script. The tool aims to provide an accessible and easy-to-use platform to conduct initial email forensics post-cyber-attack for the targeted users.
The script can be executed both on Windows and Linux platforms, albeit with different functionalities and command executions.
For further details and to view the complete source code, refer to the provided repository or script documentation.













Code Architecture Overview

The script is designed to parse email content and extract valuable information for further analysis. It is written in Python, leveraging various libraries for email handling and data extraction:
Libraries and Dependencies
•	email: For email processing and handling.
•	extract_msg: Supporting extraction from Microsoft Outlook .msg files.
•	colorama: Used for terminal text colorization.
•	re: Employed for regular expression matching.
•	sys and os: For system-level operations, path handling, and I/O operations.
Functionality Overview:
1.	Email Parsing:
•	fileChecker (): Identifies the file format (.msg or .eml) and proceeds with the relevant parsing function.
•	msgGrabber (): Extracts key details from Outlook .msg files, including sender, recipient, subject, attachments, and email body.
•	msgIPGrabber (), msgEmailGrabber (), msgURLGrabber(): Identifies and extracts IPs, email addresses, and URLs from the email body.
2.	Base Grabber (for .eml files):
•	baseGrabber (): Extracts essential header information such as sender, receiver, subject, date, etc.
3.	Additional Parsing:
•	emailGrabber (), ipGrabber (), urlGrabber (): Identifies and extracts email addresses, IPs, and URLs from the email body.
4.	Header Analysis:
•	xHunter (): Prints email headers that were added during email transmission.
5.	Attachments Handling:
•	embedAttachments (): Identifies and extracts attachments from the email.
6.	Additional Utilities:
•	remove_ansi (): Removes ANSI escape sequences from text, ensuring cleaner output.
•	banner (): Prints a project banner with details.
7.	Main Execution:
•	main (): The main entry point of the script that checks argument count and initiates the file parsing process.
